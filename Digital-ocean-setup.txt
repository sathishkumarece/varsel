https://zocada.com/deploying-node-js-application-digitalocean-setting-server/

login as: root
Authenticating with public key "rsa-key-20190430"
Passphrase for key "rsa-key-20190430":
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-145-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  Get cloud support with Ubuntu Advantage Cloud Guest:
    http://www.ubuntu.com/business/services/cloud

0 packages can be updated.
0 updates are security updates.



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

root@ubuntu-s-1vcpu-1gb-fra1-01:~#
root@ubuntu-s-1vcpu-1gb-fra1-01:~#
root@ubuntu-s-1vcpu-1gb-fra1-01:~#
root@ubuntu-s-1vcpu-1gb-fra1-01:~# who am i
root     pts/0        2019-04-29 23:49 (5.48.220.20)
root@ubuntu-s-1vcpu-1gb-fra1-01:~# uname -a
Linux ubuntu-s-1vcpu-1gb-fra1-01 4.4.0-145-generic #171-Ubuntu SMP Tue Mar 26 12:43:40 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
root@ubuntu-s-1vcpu-1gb-fra1-01:~# lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 16.04.6 LTS
Release:        16.04
Codename:       xenial



//Add our own user


root@ubuntu-s-1vcpu-1gb-fra1-01:~# adduser sathish
Adding user `sathish' ...
Adding new group `sathish' (1000) ...
Adding new user `sathish' (1000) with group `sathish' ...
Creating home directory `/home/sathish' ...
Copying files from `/etc/skel' ...
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
Changing the user information for sathish
Enter the new value, or press ENTER for the default
        Full Name []: Sathishkumar NATARAJ
        Room Number []:
        Work Phone []:
        Home Phone []: 0753257197
        Other []:
Is the information correct? [Y/n] y
root@ubuntu-s-1vcpu-1gb-fra1-01:~# id sathish
uid=1000(sathish) gid=1000(sathish) groups=1000(sathish)
root@ubuntu-s-1vcpu-1gb-fra1-01:~# usermod -aG sudo sathish
root@ubuntu-s-1vcpu-1gb-fra1-01:~# id sathish
uid=1000(sathish) gid=1000(sathish) groups=1000(sathish),27(sudo)
root@ubuntu-s-1vcpu-1gb-fra1-01:~# su -sathish
Cannot execute athish: No such file or directory
root@ubuntu-s-1vcpu-1gb-fra1-01:~# su - sathish
To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ mkdir ~/.ssh
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ chmod 700 ~/.ssh
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ nano ~/.ssh/authorized_keys
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ chmod 600 ~/.ssh/authorized_keys
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ exit
root@ubuntu-s-1vcpu-1gb-fra1-01:~$ exit


sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo nano /etc/ssh/sshd_config
[sudo] password for sathish:
update PermitRootLogin to no

sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo systemctl reload sshd









root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get update
Hit:1 http://mirrors.digitalocean.com/ubuntu xenial InRelease
Get:2 http://mirrors.digitalocean.com/ubuntu xenial-updates InRelease [109 kB]
Get:3 http://mirrors.digitalocean.com/ubuntu xenial-backports InRelease [107 kB]
Get:4 http://mirrors.digitalocean.com/ubuntu xenial/universe amd64 Packages [7,532 kB]
Get:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB]
Get:6 http://mirrors.digitalocean.com/ubuntu xenial/universe Translation-en [4,354 kB]
Get:7 http://mirrors.digitalocean.com/ubuntu xenial/multiverse amd64 Packages [144 kB]
Get:8 http://mirrors.digitalocean.com/ubuntu xenial/multiverse Translation-en [106 kB]
Get:9 http://mirrors.digitalocean.com/ubuntu xenial-updates/main amd64 Packages [947 kB]
Get:10 http://mirrors.digitalocean.com/ubuntu xenial-updates/main Translation-en [378 kB]
Get:11 http://mirrors.digitalocean.com/ubuntu xenial-updates/universe amd64 Packages [747 kB]
Get:12 http://mirrors.digitalocean.com/ubuntu xenial-updates/universe Translation-en [311 kB]
Get:13 http://mirrors.digitalocean.com/ubuntu xenial-updates/multiverse amd64 Packages [16.7 kB]
Get:14 http://mirrors.digitalocean.com/ubuntu xenial-updates/multiverse Translation-en [8,440 B]
Get:15 http://mirrors.digitalocean.com/ubuntu xenial-backports/main amd64 Packages [7,280 B]
Get:16 http://mirrors.digitalocean.com/ubuntu xenial-backports/main Translation-en [4,456 B]
Get:17 http://mirrors.digitalocean.com/ubuntu xenial-backports/universe amd64 Packages [7,804 B]
Get:18 http://mirrors.digitalocean.com/ubuntu xenial-backports/universe Translation-en [4,184 B]
Get:19 http://security.ubuntu.com/ubuntu xenial-security/main amd64 Packages [638 kB]
Get:20 http://security.ubuntu.com/ubuntu xenial-security/main Translation-en [261 kB]
Get:21 http://security.ubuntu.com/ubuntu xenial-security/universe amd64 Packages [434 kB]
Get:22 http://security.ubuntu.com/ubuntu xenial-security/universe Translation-en [176 kB]
Get:23 http://security.ubuntu.com/ubuntu xenial-security/multiverse amd64 Packages [5,604 B]
Get:24 http://security.ubuntu.com/ubuntu xenial-security/multiverse Translation-en [2,676 B]
Fetched 16.4 MB in 3s (5,142 kB/s)
Reading package lists... Done
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get install nodejs
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following package was automatically installed and is no longer required:
  grub-pc-bin
Use 'sudo apt autoremove' to remove it.
The following additional packages will be installed:
  libuv1
The following NEW packages will be installed:
  libuv1 nodejs
0 upgraded, 2 newly installed, 0 to remove and 42 not upgraded.
Need to get 3,219 kB of archives.
After this operation, 13.4 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://mirrors.digitalocean.com/ubuntu xenial/universe amd64 libuv1 amd64 1.8.0-1 [57.4 kB]
Get:2 http://mirrors.digitalocean.com/ubuntu xenial-updates/universe amd64 nodejs amd64 4.2.6~dfsg-1ubuntu4.2 [3,162 kB]
Fetched 3,219 kB in 0s (20.2 MB/s)
Selecting previously unselected package libuv1:amd64.
(Reading database ... 54530 files and directories currently installed.)
Preparing to unpack .../libuv1_1.8.0-1_amd64.deb ...
Unpacking libuv1:amd64 (1.8.0-1) ...
Selecting previously unselected package nodejs.
Preparing to unpack .../nodejs_4.2.6~dfsg-1ubuntu4.2_amd64.deb ...
Unpacking nodejs (4.2.6~dfsg-1ubuntu4.2) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up libuv1:amd64 (1.8.0-1) ...
Setting up nodejs (4.2.6~dfsg-1ubuntu4.2) ...
update-alternatives: using /usr/bin/nodejs to provide /usr/bin/js (js) in auto mode
Processing triggers for libc-bin (2.23-0ubuntu11) ...

root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get install npm

root@ubuntu-s-1vcpu-1gb-fra1-01:~# nodejs -v
v4.2.6
root@ubuntu-s-1vcpu-1gb-fra1-01:~# cd ~
root@ubuntu-s-1vcpu-1gb-fra1-01:~# curl -sL https://deb.nodesource.com/setup_8.x -o nodesource_setup.sh
root@ubuntu-s-1vcpu-1gb-fra1-01:~# nano nodesource_setup.sh
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get install nodejs
Reading package lists... Done
Building dependency tree
Reading state information... Done
nodejs is already the newest version (4.2.6~dfsg-1ubuntu4.2).
The following package was automatically installed and is no longer required:
  grub-pc-bin
Use 'sudo apt autoremove' to remove it.
0 upgraded, 0 newly installed, 0 to remove and 42 not upgraded.
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo bash nodesource_setup.sh

## Installing the NodeSource Node.js 8.x LTS Carbon repo...


## Populating apt-get cache...

+ apt-get update
Hit:1 http://security.ubuntu.com/ubuntu xenial-security InRelease
Hit:2 http://mirrors.digitalocean.com/ubuntu xenial InRelease
Hit:3 http://mirrors.digitalocean.com/ubuntu xenial-updates InRelease
Hit:4 http://mirrors.digitalocean.com/ubuntu xenial-backports InRelease
Reading package lists... Done

## Confirming "xenial" is supported...

+ curl -sLf -o /dev/null 'https://deb.nodesource.com/node_8.x/dists/xenial/Release'

## Adding the NodeSource signing key to your keyring...

+ curl -s https://deb.nodesource.com/gpgkey/nodesource.gpg.key | apt-key add -
OK

## Creating apt sources list file for the NodeSource Node.js 8.x LTS Carbon repo...

+ echo 'deb https://deb.nodesource.com/node_8.x xenial main' > /etc/apt/sources.list.d/nodesource.list
+ echo 'deb-src https://deb.nodesource.com/node_8.x xenial main' >> /etc/apt/sources.list.d/nodesource.list

## Running `apt-get update` for you...

+ apt-get update
Hit:1 http://security.ubuntu.com/ubuntu xenial-security InRelease
Hit:2 http://mirrors.digitalocean.com/ubuntu xenial InRelease
Get:3 https://deb.nodesource.com/node_8.x xenial InRelease [4,619 B]
Hit:4 http://mirrors.digitalocean.com/ubuntu xenial-updates InRelease
Hit:5 http://mirrors.digitalocean.com/ubuntu xenial-backports InRelease
Get:6 https://deb.nodesource.com/node_8.x xenial/main Sources [761 B]
Get:7 https://deb.nodesource.com/node_8.x xenial/main amd64 Packages [1,005 B]
Fetched 6,385 B in 0s (12.8 kB/s)
Reading package lists... Done

## Run `sudo apt-get install -y nodejs` to install Node.js 8.x LTS Carbon and npm
## You may also need development tools to build native addons:
     sudo apt-get install gcc g++ make
## To install the Yarn package manager, run:
     curl -sL https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
     echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
     sudo apt-get update && sudo apt-get install yarn


root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get install nodejs
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following packages were automatically installed and are no longer required:
  grub-pc-bin gyp javascript-common libjs-inherits libjs-jquery libjs-node-uuid libjs-underscore libssl-dev libssl-doc libuv1 libuv1-dev node-abbrev node-ansi
  node-ansi-color-table node-archy node-async node-block-stream node-combined-stream node-cookie-jar node-delayed-stream node-forever-agent node-form-data
  node-fstream node-fstream-ignore node-github-url-from-git node-glob node-graceful-fs node-gyp node-inherits node-ini node-json-stringify-safe node-lockfile
  node-lru-cache node-mime node-minimatch node-mkdirp node-mute-stream node-node-uuid node-nopt node-normalize-package-data node-npmlog node-once node-osenv node-qs
  node-read node-read-package-json node-request node-retry node-rimraf node-semver node-sha node-sigmund node-slide node-tar node-tunnel-agent node-underscore
  node-which python-pkg-resources zlib1g-dev
Use 'sudo apt autoremove' to remove them.
The following packages will be REMOVED:
  nodejs-dev npm
The following packages will be upgraded:
  nodejs
1 upgraded, 0 newly installed, 2 to remove and 42 not upgraded.
Need to get 13.6 MB of archives.
After this operation, 39.4 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 https://deb.nodesource.com/node_8.x xenial/main amd64 nodejs amd64 8.16.0-1nodesource1 [13.6 MB]
Fetched 13.6 MB in 0s (53.5 MB/s)
(Reading database ... 65894 files and directories currently installed.)
Removing npm (3.5.2-0ubuntu4) ...
dpkg: nodejs-dev: dependency problems, but removing anyway as you requested:
 node-gyp depends on nodejs-dev.

Removing nodejs-dev (4.2.6~dfsg-1ubuntu4.2) ...
Processing triggers for man-db (2.7.5-1) ...
(Reading database ... 62836 files and directories currently installed.)
Preparing to unpack .../nodejs_8.16.0-1nodesource1_amd64.deb ...
Unpacking nodejs (8.16.0-1nodesource1) over (4.2.6~dfsg-1ubuntu4.2) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up nodejs (8.16.0-1nodesource1) ...
root@ubuntu-s-1vcpu-1gb-fra1-01:~#
root@ubuntu-s-1vcpu-1gb-fra1-01:~# nodejs -v
v8.16.0
root@ubuntu-s-1vcpu-1gb-fra1-01:~# npm -v
6.4.1
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get install build-essential
Reading package lists... Done
Building dependency tree
Reading state information... Done
build-essential is already the newest version (12.1ubuntu2).
build-essential set to manually installed.
The following packages were automatically installed and are no longer required:
  grub-pc-bin gyp javascript-common libjs-inherits libjs-jquery libjs-node-uuid libjs-underscore libssl-dev libssl-doc libuv1 libuv1-dev node-abbrev node-ansi
  node-ansi-color-table node-archy node-async node-block-stream node-combined-stream node-cookie-jar node-delayed-stream node-forever-agent node-form-data
  node-fstream node-fstream-ignore node-github-url-from-git node-glob node-graceful-fs node-gyp node-inherits node-ini node-json-stringify-safe node-lockfile
  node-lru-cache node-mime node-minimatch node-mkdirp node-mute-stream node-node-uuid node-nopt node-normalize-package-data node-npmlog node-once node-osenv node-qs
  node-read node-read-package-json node-request node-retry node-rimraf node-semver node-sha node-sigmund node-slide node-tar node-tunnel-agent node-underscore
  node-which python-pkg-resources zlib1g-dev
Use 'sudo apt autoremove' to remove them.
0 upgraded, 0 newly installed, 0 to remove and 42 not upgraded.
















root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0C49F3730359A14518585931BC711F9BA15703C6
Executing: /tmp/tmp.KJNexouxMi/gpg.1.sh --keyserver
hkp://keyserver.ubuntu.com:80
--recv
0C49F3730359A14518585931BC711F9BA15703C6
gpg: requesting key A15703C6 from hkp server keyserver.ubuntu.com
gpg: key A15703C6: public key "MongoDB 3.4 Release Signing Key <packaging@mongodb.com>" imported
gpg: Total number processed: 1
gpg:               imported: 1  (RSA: 1)
root@ubuntu-s-1vcpu-1gb-fra1-01:~# echo "deb [ arch=amd64,arm64 ] http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.4.list
deb [ arch=amd64,arm64 ] http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 multiverse
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get update
Ign:1 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 InRelease
Get:2 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 Release [3,457 B]
Get:3 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 Release.gpg [801 B]
Hit:4 http://mirrors.digitalocean.com/ubuntu xenial InRelease
Hit:5 http://security.ubuntu.com/ubuntu xenial-security InRelease
Get:6 http://mirrors.digitalocean.com/ubuntu xenial-updates InRelease [109 kB]
Get:7 http://mirrors.digitalocean.com/ubuntu xenial-backports InRelease [107 kB]
Hit:8 https://deb.nodesource.com/node_8.x xenial InRelease
Get:9 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4/multiverse amd64 Packages [14.1 kB]
Get:10 http://mirrors.digitalocean.com/ubuntu xenial-updates/main amd64 Packages [947 kB]
Get:11 http://mirrors.digitalocean.com/ubuntu xenial-updates/universe amd64 Packages [747 kB]
Get:12 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4/multiverse arm64 Packages [14.2 kB]
Fetched 1,942 kB in 0s (2,721 kB/s)
Reading package lists... Done
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get install mongodb-org
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following packages were automatically installed and are no longer required:
  grub-pc-bin gyp javascript-common libjs-inherits libjs-jquery libjs-node-uuid libjs-underscore libssl-dev libssl-doc libuv1 libuv1-dev node-abbrev node-ansi
  node-ansi-color-table node-archy node-async node-block-stream node-combined-stream node-cookie-jar node-delayed-stream node-forever-agent node-form-data
  node-fstream node-fstream-ignore node-github-url-from-git node-glob node-graceful-fs node-gyp node-inherits node-ini node-json-stringify-safe node-lockfile
  node-lru-cache node-mime node-minimatch node-mkdirp node-mute-stream node-node-uuid node-nopt node-normalize-package-data node-npmlog node-once node-osenv node-qs
  node-read node-read-package-json node-request node-retry node-rimraf node-semver node-sha node-sigmund node-slide node-tar node-tunnel-agent node-underscore
  node-which python-pkg-resources zlib1g-dev
Use 'sudo apt autoremove' to remove them.
The following additional packages will be installed:
  mongodb-org-mongos mongodb-org-server mongodb-org-shell mongodb-org-tools
The following NEW packages will be installed:
  mongodb-org mongodb-org-mongos mongodb-org-server mongodb-org-shell mongodb-org-tools
0 upgraded, 5 newly installed, 0 to remove and 42 not upgraded.
Need to get 87.4 MB of archives.
After this operation, 296 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4/multiverse amd64 mongodb-org-shell amd64 3.4.20 [8,011 kB]
Get:2 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4/multiverse amd64 mongodb-org-server amd64 3.4.20 [14.3 MB]
Get:3 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4/multiverse amd64 mongodb-org-mongos amd64 3.4.20 [8,307 kB]
Get:4 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4/multiverse amd64 mongodb-org-tools amd64 3.4.20 [56.7 MB]
Get:5 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4/multiverse amd64 mongodb-org amd64 3.4.20 [3,528 B]
Fetched 87.4 MB in 1s (44.8 MB/s)
Selecting previously unselected package mongodb-org-shell.
(Reading database ... 66265 files and directories currently installed.)
Preparing to unpack .../mongodb-org-shell_3.4.20_amd64.deb ...
Unpacking mongodb-org-shell (3.4.20) ...
Selecting previously unselected package mongodb-org-server.
Preparing to unpack .../mongodb-org-server_3.4.20_amd64.deb ...
Unpacking mongodb-org-server (3.4.20) ...
Selecting previously unselected package mongodb-org-mongos.
Preparing to unpack .../mongodb-org-mongos_3.4.20_amd64.deb ...
Unpacking mongodb-org-mongos (3.4.20) ...
Selecting previously unselected package mongodb-org-tools.
Preparing to unpack .../mongodb-org-tools_3.4.20_amd64.deb ...
Unpacking mongodb-org-tools (3.4.20) ...
Selecting previously unselected package mongodb-org.
Preparing to unpack .../mongodb-org_3.4.20_amd64.deb ...
Unpacking mongodb-org (3.4.20) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up mongodb-org-shell (3.4.20) ...
Setting up mongodb-org-server (3.4.20) ...
Adding system user `mongodb' (UID 112) ...
Adding new user `mongodb' (UID 112) with group `nogroup' ...
Not creating home directory `/home/mongodb'.
Adding group `mongodb' (GID 116) ...
Done.
Adding user `mongodb' to group `mongodb' ...
Adding user mongodb to group mongodb
Done.
Setting up mongodb-org-mongos (3.4.20) ...
Setting up mongodb-org-tools (3.4.20) ...
Setting up mongodb-org (3.4.20) ...

root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo systemctl start mongod
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo systemctl status mongod
● mongod.service - High-performance, schema-free document-oriented database
   Loaded: loaded (/lib/systemd/system/mongod.service; disabled; vendor preset: enabled)
   Active: active (running) since Tue 2019-04-30 00:13:37 UTC; 11s ago
     Docs: https://docs.mongodb.org/manual
 Main PID: 11784 (mongod)
    Tasks: 20
   Memory: 29.8M
      CPU: 170ms
   CGroup: /system.slice/mongod.service
           └─11784 /usr/bin/mongod --config /etc/mongod.conf

Apr 30 00:13:37 ubuntu-s-1vcpu-1gb-fra1-01 systemd[1]: Started High-performance, schema-free document-oriented database.

root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo systemctl enable mongod
Created symlink from /etc/systemd/system/multi-user.target.wants/mongod.service to /lib/systemd/system/mongod.service.


root@ubuntu-s-1vcpu-1gb-fra1-01:~# mongo
MongoDB shell version v3.4.20
connecting to: mongodb://127.0.0.1:27017
MongoDB server version: 3.4.20
Server has startup warnings:
2019-04-30T00:13:37.636+0000 I STORAGE  [initandlisten]
2019-04-30T00:13:37.636+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2019-04-30T00:13:37.636+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2019-04-30T00:13:37.752+0000 I CONTROL  [initandlisten]
2019-04-30T00:13:37.752+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2019-04-30T00:13:37.752+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2019-04-30T00:13:37.752+0000 I CONTROL  [initandlisten]
2019-04-30T00:13:37.753+0000 I CONTROL  [initandlisten]
2019-04-30T00:13:37.753+0000 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/defrag is 'always'.
2019-04-30T00:13:37.753+0000 I CONTROL  [initandlisten] **        We suggest setting it to 'never'
2019-04-30T00:13:37.753+0000 I CONTROL  [initandlisten]
> use admin
switched to db admin
> db.createUser(
  {
    user: "varsel",
    pwd: "varsel'sSecPass",
    roles: [ { role: "userAdminAnyDatabase", db: "admin" } ]
  }
)

press ctrl + C to exit

root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo nano /etc/mongod.conf

Modify the security as below
 . . .
security:
  authorization: "enabled"
 . . . 
 
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo nano /etc/mongod.conf
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo systemctl restart mongod
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo systemctl status mongod
● mongod.service - High-performance, schema-free document-oriented database
   Loaded: loaded (/lib/systemd/system/mongod.service; enabled; vendor preset: enabled)
   Active: active (running) since Tue 2019-04-30 00:28:20 UTC; 24s ago
     Docs: https://docs.mongodb.org/manual
 Main PID: 11853 (mongod)
    Tasks: 20
   Memory: 130.0M
      CPU: 682ms
   CGroup: /system.slice/mongod.service
           └─11853 /usr/bin/mongod --config /etc/mongod.conf

Apr 30 00:28:20 ubuntu-s-1vcpu-1gb-fra1-01 systemd[1]: Stopped High-performance, schema-free document-oriented database.
Apr 30 00:28:20 ubuntu-s-1vcpu-1gb-fra1-01 systemd[1]: Started High-performance, schema-free document-oriented database.
root@ubuntu-s-1vcpu-1gb-fra1-01:~# mongo
MongoDB shell version v3.4.20
connecting to: mongodb://127.0.0.1:27017
MongoDB server version: 3.4.20
> show dbs
2019-04-30T00:32:01.132+0000 E QUERY    [thread1] Error: listDatabases failed:{
        "ok" : 0,
        "errmsg" : "not authorized on admin to execute command { listDatabases: 1.0 }",
        "code" : 13,
        "codeName" : "Unauthorized"
} :
_getErrorWithCode@src/mongo/shell/utils.js:25:13
Mongo.prototype.getDBs@src/mongo/shell/mongo.js:62:1
shellHelper.show@src/mongo/shell/utils.js:814:19
shellHelper@src/mongo/shell/utils.js:704:15
@(shellhelp2):1:1
> exit
bye
root@ubuntu-s-1vcpu-1gb-fra1-01:~# mongo -u varsel -p --authenticationDatabase admin
MongoDB shell version v3.4.20
Enter password:
connecting to: mongodb://127.0.0.1:27017
MongoDB server version: 3.4.20
> show dbs
admin  0.000GB
local  0.000GB
> use varseldb
switched to db varseldb

db.createUser(
  {
    user: "varselUser",
    pwd: "pass$Varsel",
    roles: [ { role: "readWrite", db: "varseldb" } ]
  }
)
> db.createUser(
...   {
...     user: "varselUser",
...     pwd: "pass$Varsel",
...     roles: [ { role: "readWrite", db: "varseldb" } ]
...   }
... )
Successfully added user: {
        "user" : "varselUser",
        "roles" : [
                {
                        "role" : "readWrite",
                        "db" : "varseldb"
                }
        ]
}



> ^C
bye
 
 

 
 root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get update
Ign:1 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 InRelease
Hit:2 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 Release
Hit:3 http://mirrors.digitalocean.com/ubuntu xenial InRelease
Get:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB]
Hit:5 http://mirrors.digitalocean.com/ubuntu xenial-updates InRelease
Get:6 http://mirrors.digitalocean.com/ubuntu xenial-backports InRelease [107 kB]
Hit:7 https://deb.nodesource.com/node_8.x xenial InRelease
Fetched 216 kB in 0s (557 kB/s)
Reading package lists... Done
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get install git

root@ubuntu-s-1vcpu-1gb-fra1-01:~# git config --global user.name "Sathishkumar NATARAJ"
root@ubuntu-s-1vcpu-1gb-fra1-01:~# git config --global user.email "sathishkumarece@gmail.com"
root@ubuntu-s-1vcpu-1gb-fra1-01:~# git config --list
user.name=Sathishkumar NATARAJ
user.email=sathishkumarece@gmail.com



root@ubuntu-s-1vcpu-1gb-fra1-01:~$ git clone https://github.com/sathishkumarece/varsel.git
 

 
 
 
 
 root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get update
Ign:1 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 InRelease
Get:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB]
Hit:3 http://mirrors.digitalocean.com/ubuntu xenial InRelease
Hit:4 http://mirrors.digitalocean.com/ubuntu xenial-updates InRelease
Get:5 http://mirrors.digitalocean.com/ubuntu xenial-backports InRelease [107 kB]
Hit:6 http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 Release
Hit:7 https://deb.nodesource.com/node_8.x xenial InRelease
Fetched 216 kB in 0s (471 kB/s)
Reading package lists... Done
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo apt-get install nginx

root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/nginx-selfsigned.key -out /etc/ssl/certs/nginx-selfsigned.crt
Generating a 2048 bit RSA private key
....................................................+++
.........+++
writing new private key to '/etc/ssl/private/nginx-selfsigned.key'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:IN
State or Province Name (full name) [Some-State]:TN
Locality Name (eg, city) []:Coimbatore
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Varsel
Organizational Unit Name (eg, section) []:V
Common Name (e.g. server FQDN or YOUR name) []:46.101.71.76
Email Address []:sathishkumarece@gmail.com

root@ubuntu-s-1vcpu-1gb-fra1-01:/# sudo openssl dhparam -out /etc/nginx/dhparam.pem 4096
Generating DH parameters, 4096 bit long safe prime, generator 2
This is going to take a long time


root@ubuntu-s-1vcpu-1gb-fra1-01:/# sudo nano /etc/nginx/snippets/self-signed.conf
ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;

root@ubuntu-s-1vcpu-1gb-fra1-01:/# sudo nano /etc/nginx/snippets/ssl-params.conf
ssl_protocols TLSv1.2;
ssl_prefer_server_ciphers on;
ssl_dhparam /etc/nginx/dhparam.pem;
ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384;
ssl_ecdh_curve secp384r1; # Requires nginx >= 1.1.0
ssl_session_timeout  10m;
ssl_session_cache shared:SSL:10m;
ssl_session_tickets off; # Requires nginx >= 1.5.9
ssl_stapling on; # Requires nginx >= 1.3.7
ssl_stapling_verify on; # Requires nginx => 1.3.7
resolver 8.8.8.8 8.8.4.4 valid=300s;
resolver_timeout 5s;
# Disable strict transport security for now. You can uncomment the following
# line if you understand the implications.
# add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;
add_header X-XSS-Protection "1; mode=block";

sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/varsel.com
sudo nano /etc/nginx/sites-available/varsel.com

##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# http://wiki.nginx.org/Pitfalls
# http://wiki.nginx.org/QuickStart
# http://wiki.nginx.org/Configuration
#
# Generally, you will want to move this file somewhere, and start with a clean
# file but keep this around for reference. Or just disable in sites-enabled.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#
server {
        # listen 80 default_server;
        # listen [::]:80 default_server;

        # SSL configuration
        #
        listen 443 ssl;
        listen [::]:443 ssl;
        include snippets/self-signed.conf;
        include snippets/ssl-params.conf;

        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;

        root /var/www/html;

        # Add index.php to the list if you are using PHP
        index index.html index.htm index.nginx-debian.html;

        server_name 46.101.71.76 46.101.71.76:1516 ;

        location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                # try_files $uri $uri/ =404;
        }

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        #location ~ \.php$ {
        #       include snippets/fastcgi-php.conf;
        #
        #       # With php7.0-cgi alone:
        #       fastcgi_pass 127.0.0.1:9000;
        #       # With php7.0-fpm:
        #       fastcgi_pass unix:/run/php/php7.0-fpm.sock;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #       deny all;
        #}
}


# Virtual Host configuration for example.com
#
# You can move that to a different file under sites-available/ and symlink that
# to sites-enabled/ to enable it.
#
server {
        listen 80;
        listen [::]:80;

        server_name 46.101.71.76 46.101.71.76:1516 ;
        return 302 https://$server_name$request_uri;

#       root /var/www/example.com;
#       index index.html;

#       location / {
#               try_files $uri $uri/ =404;
#       }
#}


root@ubuntu-s-1vcpu-1gb-fra1-01:~# nano /etc/nginx/conf.d/ssl.conf

server {
    listen 443 http2 ssl;
    listen [::]:443 http2 ssl;

    server_name 46.101.71.76;

    ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
    ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;
    ssl_dhparam /etc/nginx/dhparam.pem;

    ########################################################################
    # from https://cipherli.st/                                            #
    # and https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html #
    ########################################################################

    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_prefer_server_ciphers on;
    ssl_ciphers "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH";
    ssl_ecdh_curve secp384r1;
    ssl_session_cache shared:SSL:10m;
    ssl_session_tickets off;
    ssl_stapling on;
    ssl_stapling_verify on;
    resolver 8.8.8.8 8.8.4.4 valid=300s;
    resolver_timeout 5s;
    # Disable preloading HSTS for now.  You can use the commented out header line that includes
    # the "preload" directive if you understand the implications.
    #add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload";
    add_header Strict-Transport-Security "max-age=63072000; includeSubdomains";
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;

    ##################################
    # END https://cipherli.st/ BLOCK #
    ##################################


    root /usr/share/nginx/html;

    location / {
    }

    error_page 404 /404.html;
    location = /404.html {
    }

    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
    }
}



root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx# ls -l
total 60
drwxr-xr-x 2 root root 4096 Apr 30 09:44 conf.d
-rw-r--r-- 1 root root  769 Apr 30 02:05 dhparam.pem
-rw-r--r-- 1 root root 1077 Feb 11  2017 fastcgi.conf
-rw-r--r-- 1 root root 1007 Feb 11  2017 fastcgi_params
-rw-r--r-- 1 root root 2837 Feb 11  2017 koi-utf
-rw-r--r-- 1 root root 2223 Feb 11  2017 koi-win
-rw-r--r-- 1 root root 3957 Feb 11  2017 mime.types
-rw-r--r-- 1 root root 1462 Feb 11  2017 nginx.conf
-rw-r--r-- 1 root root  180 Feb 11  2017 proxy_params
-rw-r--r-- 1 root root  636 Feb 11  2017 scgi_params
drwxr-xr-x 2 root root 4096 Apr 30 09:11 sites-available
drwxr-xr-x 2 root root 4096 Apr 30 00:39 sites-enabled
drwxr-xr-x 2 root root 4096 Apr 30 02:13 snippets
-rw-r--r-- 1 root root  664 Feb 11  2017 uwsgi_params
-rw-r--r-- 1 root root 3071 Feb 11  2017 win-utf
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx# mkdir default.d
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx# ls-l
ls-l: command not found
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx# ls -l
total 64
drwxr-xr-x 2 root root 4096 Apr 30 09:44 conf.d
drwxr-xr-x 2 root root 4096 Apr 30 09:46 default.d
-rw-r--r-- 1 root root  769 Apr 30 02:05 dhparam.pem
-rw-r--r-- 1 root root 1077 Feb 11  2017 fastcgi.conf
-rw-r--r-- 1 root root 1007 Feb 11  2017 fastcgi_params
-rw-r--r-- 1 root root 2837 Feb 11  2017 koi-utf
-rw-r--r-- 1 root root 2223 Feb 11  2017 koi-win
-rw-r--r-- 1 root root 3957 Feb 11  2017 mime.types
-rw-r--r-- 1 root root 1462 Feb 11  2017 nginx.conf
-rw-r--r-- 1 root root  180 Feb 11  2017 proxy_params
-rw-r--r-- 1 root root  636 Feb 11  2017 scgi_params
drwxr-xr-x 2 root root 4096 Apr 30 09:11 sites-available
drwxr-xr-x 2 root root 4096 Apr 30 00:39 sites-enabled
drwxr-xr-x 2 root root 4096 Apr 30 02:13 snippets
-rw-r--r-- 1 root root  664 Feb 11  2017 uwsgi_params
-rw-r--r-- 1 root root 3071 Feb 11  2017 win-utf
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx# cd ~
root@ubuntu-s-1vcpu-1gb-fra1-01:~# sudo nano /etc/nginx/default.d/ssl-redirect.conf

return 301 https://$host$request_uri/;

https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-nginx-in-ubuntu-16-04


root@ubuntu-s-1vcpu-1gb-fra1-01:~# cd /etc/nginx/sites-available/
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# ls -l
total 12
-rw-r--r-- 1 root root 2241 Apr 30 10:09 default
-rw-r--r-- 1 root root 2074 Apr 30 10:03 default.bak
-rw-r--r-- 1 root root 2207 Apr 30 09:11 varsel.com
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# cat default
##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# http://wiki.nginx.org/Pitfalls
# http://wiki.nginx.org/QuickStart
# http://wiki.nginx.org/Configuration
#
# Generally, you will want to move this file somewhere, and start with a clean
# file but keep this around for reference. Or just disable in sites-enabled.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#
server {
        listen 80 default_server;
        listen [::]:80 default_server;
        server_name 46.101.71.76;
        return 302 https://$server_name$request_uri;
}

server {
        # SSL configuration
        #
         listen 443 ssl http2 default_server;
         listen [::]:443 ssl http2 default_server;

        include snippets/self-signed.conf;
        include snippets/ssl-params.conf;

        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;

        root /var/www/html;

        # Add index.php to the list if you are using PHP
        index index.html index.htm index.nginx-debian.html;

        server_name _;

        location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ =404;
        }

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        #location ~ \.php$ {
        #       include snippets/fastcgi-php.conf;
        #
        #       # With php7.0-cgi alone:
        #       fastcgi_pass 127.0.0.1:9000;
        #       # With php7.0-fpm:
        #       fastcgi_pass unix:/run/php/php7.0-fpm.sock;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #       deny all;
        #}
}


# Virtual Host configuration for example.com
#
# You can move that to a different file under sites-available/ and symlink that
# to sites-enabled/ to enable it.
#
#server {
#       listen 80;
#       listen [::]:80;
#
#       server_name example.com;
#
#       root /var/www/example.com;
#       index index.html;
#
#       location / {
#               try_files $uri $uri/ =404;
#       }
#}


root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw app list
Available applications:
  Nginx Full
  Nginx HTTP
  Nginx HTTPS
  OpenSSH

root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw status
Status: inactive
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw allow 'Nginx Full'
Rules updated
Rules updated (v6)
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw status     Status: inactive
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw delete allow 'Nginx HTTP'
Could not delete non-existent rule
Could not delete non-existent rule (v6)
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw status     Status: inactive
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo systemctl restart nginx
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw status     Status: inactive
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw enable
Command may disrupt existing ssh connections. Proceed with operation (y|n)? y
Firewall is active and enabled on system startup
root@ubuntu-s-1vcpu-1gb-fra1-01:/etc/nginx/sites-available# sudo ufw status
Status: active

To                         Action      From
--                         ------      ----
Nginx Full                 ALLOW       Anywhere
Nginx Full (v6)            ALLOW       Anywhere (v6)



sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo apt-get install bc
[sudo] password for sathish:
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following packages were automatically installed and are no longer required:
  grub-pc-bin libuv1
Use 'sudo apt autoremove' to remove them.
The following NEW packages will be installed:
  bc
0 upgraded, 1 newly installed, 0 to remove and 43 not upgraded.
Need to get 82.6 kB of archives.
After this operation, 246 kB of additional disk space will be used.
Get:1 http://mirrors.digitalocean.com/ubuntu xenial/main amd64 bc amd64 1.06.95-9build1 [82.6 kB]
Fetched 82.6 kB in 0s (1,029 kB/s)
Selecting previously unselected package bc.
(Reading database ... 63986 files and directories currently installed.)
Preparing to unpack .../bc_1.06.95-9build1_amd64.deb ...
Unpacking bc (1.06.95-9build1) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for install-info (6.1.0.dfsg.1-5) ...
Setting up bc (1.06.95-9build1) ...
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo git clone https://github.com/letsencrypt/letsencrypt /opt/letsencrypt
Cloning into '/opt/letsencrypt'...
remote: Enumerating objects: 16, done.
remote: Counting objects: 100% (16/16), done.
remote: Compressing objects: 100% (16/16), done.
remote: Total 64762 (delta 5), reused 3 (delta 0), pack-reused 64746
Receiving objects: 100% (64762/64762), 21.41 MiB | 13.02 MiB/s, done.
Resolving deltas: 100% (47347/47347), done.
Checking connectivity... done.
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ dig +short varsel.tk
46.101.69.101
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ cd /opt/letsencrypt/
sathish@ubuntu-s-1vcpu-1gb-fra1-01:/opt/letsencrypt$ ./certbot-auto certonly --standalone
sathish@ubuntu-s-1vcpu-1gb-fra1-01:/opt/letsencrypt$ /opt/letsencrypt/certbot-auto renew
Requesting to rerun /opt/letsencrypt/certbot-auto with root privileges...

Saving debug log to /var/log/letsencrypt/letsencrypt.log

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Processing /etc/letsencrypt/renewal/varsel.tk.conf
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Cert not yet due for renewal

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

The following certs are not due for renewal yet:
  /etc/letsencrypt/live/varsel.tk/fullchain.pem expires on 2019-07-31 (skipped)
No renewals were attempted.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
sudo crontab -e
00 1 * * 1 /opt/letsencrypt/certbot-auto renew >> /var/log/letsencrypt-renewal.log
30 1 * * 1 /bin/systemctl reload nginx

sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo apt-get install nginx
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following packages were automatically installed and are no longer required:
  grub-pc-bin libuv1
Use 'sudo apt autoremove' to remove them.

sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo cp /etc/nginx/sites-enabled/default /etc/nginx/sites-enabled/default.bak
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo nano /etc/nginx/sites-enabled/default
<<-
server {
    listen 80;
    listen [::]:80 default_server ipv6only=on;
    return 301 https://$host$request_uri;
}
->>
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048
Generating DH parameters, 2048 bit long safe prime, generator 2
This is going to take a long time


sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo nano /etc/nginx/snippets/ssl-params.conf
<<-
# See https://cipherli.st/ for details on this configuration
ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
ssl_prefer_server_ciphers on;
ssl_ciphers "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH";
ssl_ecdh_curve secp384r1; # Requires nginx >= 1.1.0
ssl_session_cache shared:SSL:10m;
ssl_session_tickets off; # Requires nginx >= 1.5.9
ssl_stapling on; # Requires nginx >= 1.3.7
ssl_stapling_verify on; # Requires nginx => 1.3.7
resolver 8.8.8.8 8.8.4.4 valid=300s;
resolver_timeout 5s;
add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;

# Add our strong Diffie-Hellman group
ssl_dhparam /etc/ssl/certs/dhparam.pem;
->>

sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo nano /etc/nginx/sites-enabled/default
<<-
# HTTPS — proxy all requests to the Node app
server {
    # Enable HTTP/2
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name varsel.tk;

    # Use the Let’s Encrypt certificates
    ssl_certificate /etc/letsencrypt/live/varsel.tk/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/varsel.tk/privkey.pem;

    # Include the SSL configuration from cipherli.st
    include snippets/ssl-params.conf;

    location / {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-NginX-Proxy true;
        proxy_pass http://localhost:1516/;
        proxy_ssl_session_reuse off;
        proxy_set_header Host $http_host;
        proxy_cache_bypass $http_upgrade;
        proxy_redirect off;
    }
}
->>

sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
sathish@ubuntu-s-1vcpu-1gb-fra1-01:~$ sudo systemctl start nginx


Running application

DATABASE_SERVICE_NAME='mongodb' MONGODB_SERVICE_PORT='27017' MONGODB_PASSWORD='pass$Varsel' MONGODB_DATABASE='varseldb'  MONGODB_SERVICE_HOST='127.0.0.1' MONGODB_USER='varselUser' npm start